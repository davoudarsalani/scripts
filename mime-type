#!/usr/bin/env bash

## By Davoud Arsalani
##    https://github.com/davoudarsalani/scripts
##    https://github.com/davoudarsalani/scripts/blob/master/mime-type
##    https://davoudarsalani.ir

## @last-modified 1401-08-03 09:30:40 +0330 Tuesday

source "$HOME"/scripts/gb

title="${0##*/}"

function display_help {
    source "$HOME"/scripts/.help
    mime_type_help
}

function prompt {
    for _ in "$@"; {
        case "$1" in
            -n ) name="${name:-"$(get_input 'directory/fie name')"}" ;;
        esac
        shift
    }
}

function get_opt {
    local options

    options="$(getopt --longoptions 'help,name:' --options 'hn:' --alternative -- "$@")"
    eval set -- "$options"
    while true; do
        case "$1" in
            -h|--help )
                display_help ;;
            -n|--name )
                shift
                name="$1" ;;
            -- )
                break ;;
        esac
        shift
    done
}

get_opt "$@"
heading "$title"

main_item="$(pipe_to_fzf 'mime-type' 'help')" && wrap_fzf_choice "$main_item" || exit 37

case "$main_item" in
    mime-type )
        prompt -n
        file --mime-type "$name" -bL && accomplished
        exit ;;
    help )
        display_help ;;
esac
